p8105_hw6_dcm2192
================
Dylan Morgan
2024-12-02

Load packages.

``` r
library(tidyverse)
library(modelr)
library(mgcv)
```

## Problem 2

Load data.

``` r
homicide_data <- read_csv("./data/homicide-data.csv")
```

    ## Rows: 52179 Columns: 12
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (9): uid, victim_last, victim_first, victim_race, victim_age, victim_sex...
    ## dbl (3): reported_date, lat, lon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Create city_state variable and homicide solved binary variable. Remove
cities with missing or inaccurate data. Limit victim_race data to black
or white, and make victim_age numeric.

``` r
homicide_data <-
  homicide_data |>
  mutate(
    city_state = str_c(city, ", ", state), 
    solved = as.numeric(disposition == "Closed by arrest"), 
    victim_age = as.numeric(victim_age)
  ) |> 
  filter(!(city_state %in% c("Dallas, TX", "Phoenix, AZ", "Kansas City, MO", "Tulsa, AL")), 
         victim_race %in% c("White", "Black")
         )
```

    ## Warning: There was 1 warning in `mutate()`.
    ## ℹ In argument: `victim_age = as.numeric(victim_age)`.
    ## Caused by warning:
    ## ! NAs introduced by coercion

For the city of Baltimore, MD, use the glm function to fit a logistic
regression with resolved vs unresolved as the outcome and victim age,
sex and race as predictors. Save the output of glm as an R object; apply
the broom::tidy to this object; and obtain the estimate and confidence
interval of the adjusted odds ratio for solving homicides comparing male
victims to female victims keeping all other variables fixed.

Create Baltimore dataset.

``` r
baltimore_homicide_data <- 
  homicide_data |> 
  filter(city_state == "Baltimore, MD")
```

Fit logistic regression to Baltimore homicide data. Present estimate and
CI of OR for solving homicides comparing male victims to female victims,
with all other variables fixed.

``` r
baltimore_fit_log <- 
  baltimore_homicide_data |> 
  glm(solved ~ victim_age + victim_sex + victim_race, data = _, family = binomial())

baltimore_fit_log |>
  broom::tidy() |>
  mutate(OR = exp(estimate), 
         CI_lower = confint(baltimore_fit_log)[,1], 
         CI_upper = confint(baltimore_fit_log)[,2]) |>
  select(term, log_OR = estimate, OR, CI_lower, CI_upper, p.value) |>
  knitr::kable(digits = 3)
```

    ## Waiting for profiling to be done...
    ## Waiting for profiling to be done...

| term             | log_OR |    OR | CI_lower | CI_upper | p.value |
|:-----------------|-------:|------:|---------:|---------:|--------:|
| (Intercept)      |  0.310 | 1.363 |   -0.025 |    0.648 |   0.070 |
| victim_age       | -0.007 | 0.993 |   -0.013 |    0.000 |   0.043 |
| victim_sexMale   | -0.854 | 0.426 |   -1.126 |   -0.584 |   0.000 |
| victim_raceWhite |  0.842 | 2.320 |    0.501 |    1.187 |   0.000 |
